# üìö Sistema de Gesti√≥n de Librer√≠as y Empresa con JPA/Hibernate

![Java Badge](https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=openjdk&logoColor=white)
![MySQL Badge](https://img.shields.io/badge/MySQL-00000F?style=for-the-badge&logo=mysql&logoColor=white)
![Hibernate Badge](https://img.shields.io/badge/Hibernate-59666C?style=for-the-badge&logo=hibernate&logoColor=white)
![Maven Badge](https://img.shields.io/badge/Apache_Maven-C71A36?style=for-the-badge&logo=apache-maven&logoColor=white)

## üìë √çndice
1. [Descripci√≥n y Objetivos](#-descripci√≥n-y-objetivos)
2. [Requisitos del Sistema](#-requisitos-del-sistema)
3. [Arquitectura y Dise√±o](#-arquitectura-y-dise√±o)
4. [Modelo de Datos](#-modelo-de-datos)
5. [Funcionalidades Implementadas](#-funcionalidades-implementadas)
6. [Decisiones T√©cnicas](#-decisiones-t√©cnicas)
7. [Resultados y Evidencias](#-resultados-y-evidencias)
8. [Instalaci√≥n y Configuraci√≥n](#-instalaci√≥n-y-configuraci√≥n)

## üìã Descripci√≥n y Objetivos

Este sistema implementa la gesti√≥n de una cadena de librer√≠as y un modelo empresarial utilizando JPA/Hibernate. El proyecto responde a los requerimientos de la asignatura de Acceso a Datos, demostrando las relaciones entre entidades (1:1, 1:N, N:M) con JPA.

### üéØ Objetivos Principales

- **Requerimiento 1**: Modelo de datos para gestionar una cadena de librer√≠as, con relaciones bidireccionales entre autores, editoriales, libros y librer√≠as.
- **Requerimiento 2**: Modelo empresarial que demuestra los tres tipos de relaciones (1:1, 1:N, N:M), utilizando empleados, departamentos, direcciones y proyectos.
- **Consultas**: Implementaci√≥n de diferentes consultas para demostrar el funcionamiento correcto de las relaciones.

## üíª Requisitos del Sistema

- Java JDK 23
- MySQL 9.1.0
- Hibernate ORM 6.6.3.Final
- Maven
- Lombok

## üèó Arquitectura y Dise√±o

### üìê Patrones Implementados

- **Patr√≥n DAO**: Abstracci√≥n del acceso a datos con objetos DAO espec√≠ficos para cada entidad
- **Patr√≥n Service**: Centralizaci√≥n de l√≥gica de negocio
- **Patr√≥n Singleton**: En `HibernateUtil` para gestionar la sesi√≥n de Hibernate
- **Arquitectura en Capas**: Separaci√≥n entre controladores, servicios, DAOs y modelos
- **Relaciones Bidireccionales**: Implementaci√≥n de asociaciones en ambos extremos

### üîÑ Estructura del Sistema

```ascii
Usuario
   ‚Üì
MainController
   ‚Üì
CompanyController / BookstoreController
   ‚Üì
Services (BookstoreService / CompanyService)
   ‚Üì
DAO Layer (AutorDAO, LibroDAO, EmpleadoDAO, etc.)
   ‚Üì
Entities (JPA Models)
   ‚Üì
HibernateUtil
   ‚Üì
MySQL DB
```

### üìö Capas del Sistema

1. **Controladores**: Manejo del flujo y men√∫s de la aplicaci√≥n
2. **Servicios**: L√≥gica de negocio y orquestaci√≥n de operaciones
3. **DAOs**: Operaciones CRUD y consultas mediante JPQL/Named Queries
4. **Entidades**: Clases con anotaciones JPA/Hibernate y m√©todos auxiliares
5. **Utilidades**: Conexi√≥n a BD, constantes y configuraci√≥n

## üóÉ Modelo de Datos

### Requerimiento 1: Sistema de Librer√≠as

#### Entidades y Relaciones:

1. **Autor (1:N con Libro)**
   - Atributos: id, nombre, apellidos, fechaNacimiento
   - Relaci√≥n: Un autor escribe muchos libros

2. **Editorial (1:N con Libro)**
   - Atributos: id, nombre, direcci√≥n
   - Relaci√≥n: Una editorial publica muchos libros

3. **Libro (N:1 con Autor/Editorial, N:M con Librer√≠a)**
   - Atributos: id, t√≠tulo, precio
   - Relaciones: Pertenece a un autor y editorial, est√° en varias librer√≠as

4. **Librer√≠a (N:M con Libro)**
   - Atributos: id, nombre, nombreDue√±o, direcci√≥n
   - Relaci√≥n: Una librer√≠a tiene muchos libros

### Requerimiento 2: Sistema Empresarial

#### Entidades y Relaciones:

1. **Empleado (1:1, N:1, N:M)**
   - Atributos: id, nombre, apellido, email, fechaContratacion, salario
   - Relaciones:
      - Tiene una direcci√≥n (1:1)
      - Pertenece a un departamento (N:1)
      - Participa en m√∫ltiples proyectos (N:M)

2. **Direcci√≥n (1:1 con Empleado)**
   - Atributos: id, calle, ciudad, codigoPostal, pa√≠s

3. **Departamento (1:N con Empleado)**
   - Atributos: id, nombre, descripci√≥n, ubicaci√≥n

4. **Proyecto (N:M con Empleado)**
   - Atributos: id, nombre, descripci√≥n, fechaInicio, fechaFin, presupuesto

## ‚ö° Funcionalidades Implementadas

### üìñ Sistema de Librer√≠as

- **Gesti√≥n completa** de autores, editoriales, libros y librer√≠as
- **Consultas principales**:
   - Mostrar libros con su editorial y autor
   - Mostrar autores con sus libros asociados
   - Mostrar librer√≠as con sus libros
   - Mostrar libros y las librer√≠as donde est√°n disponibles

### üè¢ Sistema Empresarial

- **Relaci√≥n Uno a Uno**: Empleado-Direcci√≥n
   - Asociaci√≥n directa entre un empleado y su direcci√≥n

- **Relaci√≥n Uno a Muchos**: Departamento-Empleados
   - Un departamento contiene m√∫ltiples empleados

- **Relaci√≥n Muchos a Muchos**: Empleado-Proyecto
   - Empleados participan en m√∫ltiples proyectos
   - Proyectos tienen varios empleados asignados

## ‚öôÔ∏è Decisiones T√©cnicas

### üß© Patrones y Pr√°cticas Clave

1. **Named Queries**
   - Consultas JPQL centralizadas en las entidades
   - Consultas reutilizables y mejor organizadas

2. **M√©todos Helper para Relaciones**
   - M√©todos como `addLibro()`, `asignarProyecto()`, etc.
   - Mantienen la consistencia bidireccional de las relaciones

3. **Gesti√≥n de Transacciones**
   - Control granular en los DAOs
   - Soporte para transacciones anidadas

4. **Uso de Cascadas**
   - CascadeType.ALL para relaciones 1:1
   - CascadeType.PERSIST y MERGE para otras relaciones
   - Evita eliminaciones en cascada no deseadas

5. **Lazy Loading**
   - Optimizaci√≥n con FetchType.LAZY
   - FETCH JOIN para consultas espec√≠ficas

6. **Lombok**
   - Reduce c√≥digo boilerplate manteniendo claridad
   - Anotaciones @Getter, @Setter, etc.

7. **HibernateUtil**
   - Patr√≥n Singleton para gesti√≥n de sesiones
   - Gesti√≥n expl√≠cita de recursos y transacciones

## üìä Resultados y Evidencias

### Men√∫s del Sistema

La aplicaci√≥n presenta una interfaz de consola con men√∫s intuitivos:

```
===== SISTEMA DE GESTI√ìN JPA =====
1. Gesti√≥n de Librer√≠a (Requerimiento 1)
2. Gesti√≥n de Empresa (Requerimiento 2)
3. Salir del sistema
```

#### Men√∫ de Gesti√≥n de Librer√≠a
```
===== GESTI√ìN DE LIBRER√çA =====
1. Crear datos de ejemplo
2. Mostrar libros con editorial y autor
3. Mostrar autores con sus libros
4. Mostrar librer√≠as con sus libros
5. Mostrar libros y sus librer√≠as
6. Eliminar todos los datos
7. Volver al men√∫ principal
```

#### Men√∫ de Gesti√≥n de Empresa
```
===== GESTI√ìN DE EMPRESA =====
1. Crear datos de ejemplo
2. Mostrar relaci√≥n Uno a Uno (Empleado-Direcci√≥n)
3. Mostrar relaci√≥n Uno a Muchos (Departamento-Empleados)
4. Mostrar relaci√≥n Muchos a Muchos (Empleado-Proyecto)
5. Eliminar todos los datos
6. Volver al men√∫ principal
```

### Ejemplos de Consultas Ejecutadas

#### Requerimiento 1: Librer√≠as

1. **Libros con editorial y autor**:
```
===== CONSULTA 1: TODOS LOS LIBROS CON SU EDITORIAL Y AUTOR =====
Libro: La fiesta del chivo - Precio: 26.75‚Ç¨ - Editorial: Penguin Random House - Autor: Mario Vargas Llosa
Libro: La ciudad y los perros - Precio: 24.50‚Ç¨ - Editorial: Penguin Random House - Autor: Mario Vargas Llosa
Libro: El amor en los tiempos del c√≥lera - Precio: 22.50‚Ç¨ - Editorial: Penguin Random House - Autor: Gabriel Garc√≠a M√°rquez
Libro: Cien a√±os de soledad - Precio: 25.99‚Ç¨ - Editorial: Penguin Random House - Autor: Gabriel Garc√≠a M√°rquez
Libro: Eva Luna - Precio: 19.99‚Ç¨ - Editorial: Planeta - Autor: Isabel Allende
Libro: La casa de los esp√≠ritus - Precio: 21.75‚Ç¨ - Editorial: Planeta - Autor: Isabel Allende
Libro: El oto√±o del patriarca - Precio: 20.25‚Ç¨ - Editorial: Planeta - Autor: Gabriel Garc√≠a M√°rquez
Libro: Cr√≥nica de una muerte anunciada - Precio: 18.99‚Ç¨ - Editorial: Planeta - Autor: Gabriel Garc√≠a M√°rquez
```

2. **Autores con sus libros**:
```
===== CONSULTA 2: TODOS LOS AUTORES CON SUS LIBROS ASOCIADOS =====
Autor: Gabriel Garc√≠a M√°rquez
  - Cien a√±os de soledad (25.99‚Ç¨)
  - El amor en los tiempos del c√≥lera (22.50‚Ç¨)
  - Cr√≥nica de una muerte anunciada (18.99‚Ç¨)
  - El oto√±o del patriarca (20.25‚Ç¨)

Autor: Isabel Allende
  - La casa de los esp√≠ritus (21.75‚Ç¨)
  - Eva Luna (19.99‚Ç¨)

Autor: Mario Vargas Llosa
  - La ciudad y los perros (24.50‚Ç¨)
  - La fiesta del chivo (26.75‚Ç¨)
```

3. **Librer√≠as con sus libros**:
```
===== CONSULTA 3: TODAS LAS LIBRER√çAS CON SUS LIBROS ASOCIADOS =====
Librer√≠a: El Rinc√≥n Literario - Due√±o: Ana G√≥mez - Direcci√≥n: Calle Mayor 12, Madrid
  - La ciudad y los perros
  - Cien a√±os de soledad
  - La casa de los esp√≠ritus
  - Cr√≥nica de una muerte anunciada

Librer√≠a: Libros y M√°s - Due√±o: Carlos Ruiz - Direcci√≥n: Avenida Libertad 45, Barcelona
  - La fiesta del chivo
  - El amor en los tiempos del c√≥lera
  - Eva Luna
  - El oto√±o del patriarca
```

#### Requerimiento 2: Empresa

1. **Relaci√≥n Uno a Uno**:
```
===== RELACI√ìN UNO A UNO (Empleado-Direcci√≥n) =====
Empleado: Juan P√©rez
Direcci√≥n: Calle Mayor 10, Madrid, 28001, Espa√±a

Empleado: Mar√≠a L√≥pez
Direcci√≥n: Avenida Diagonal 100, Barcelona, 08018, Espa√±a

Empleado: Carlos G√≥mez
Direcci√≥n: Plaza Nueva 5, Sevilla, 41001, Espa√±a

Empleado: Ana Mart√≠nez
Direcci√≥n: Gran V√≠a 30, Madrid, 28013, Espa√±a
```

2. **Relaci√≥n Uno a Muchos**:
```
===== RELACI√ìN UNO A MUCHOS (Departamento-Empleados) =====
Departamento: Tecnolog√≠a - Departamento de Tecnolog√≠a e Innovaci√≥n - Ubicaci√≥n: Planta 3
  Empleados:
  - Juan P√©rez - Contratado: 2020-01-15
  - Mar√≠a L√≥pez - Contratado: 2019-05-10

Departamento: RRHH - Recursos Humanos - Ubicaci√≥n: Planta 2
  Empleados:
  - Carlos G√≥mez - Contratado: 2021-03-22

Departamento: Marketing - Departamento de Marketing y Ventas - Ubicaci√≥n: Planta 1
  Empleados:
  - Ana Mart√≠nez - Contratado: 2018-11-05
```

3. **Relaci√≥n Muchos a Muchos**:
```
===== RELACI√ìN MUCHOS A MUCHOS (Proyecto-Empleados) =====
--- Proyectos y sus Empleados: ---
Proyecto: Web Corporativa - Redise√±o de la web corporativa - Presupuesto: 25000.0‚Ç¨
  Empleados asignados:
  - Juan P√©rez - juan.perez@empresa.com
  - Ana Mart√≠nez - ana.martinez@empresa.com

Proyecto: App M√≥vil - Desarrollo de app para clientes - Presupuesto: 45000.0‚Ç¨
  Empleados asignados:
  - Mar√≠a L√≥pez - maria.lopez@empresa.com
  - Juan P√©rez - juan.perez@empresa.com
```

## üíæ Base de Datos

### Modelo Resumido

El sistema utiliza las siguientes tablas principales:

**Requerimiento 1 (Librer√≠as)**:
- AUTORES: id, nombre, apellidos, fecha_nacimiento
- EDITORIALES: id, nombre, direccion
- LIBROS: id, titulo, precio, autor_id, editorial_id
- LIBRERIAS: id, nombre, nombre_dueno, direccion
- LIBRERIA_LIBRO: libreria_id, libro_id (tabla de uni√≥n)

**Requerimiento 2 (Empresa)**:
- EMPLEADOS: id, nombre, apellido, email, fecha_contratacion, salario, direccion_id, departamento_id
- DIRECCIONES: id, calle, ciudad, codigo_postal, pais
- DEPARTAMENTOS: id, nombre, descripcion, ubicacion
- PROYECTOS: id, nombre, descripcion, fecha_inicio, fecha_fin, presupuesto
- EMPLEADO_PROYECTO: empleado_id, proyecto_id (tabla de uni√≥n)

## üì• Instalaci√≥n y Configuraci√≥n

1. Clonar el repositorio
2. Configurar la base de datos MySQL ejecutando script.sql
3. Ajustar hibernate.cfg.xml con los datos de conexi√≥n
4. Compilar con Maven: `mvn clean install`
5. Ejecutar: `java -jar target/AE_4_JPA-1.0-SNAPSHOT.jar`

---

## ‚úíÔ∏è Autores
* **Oriol Macias** - *Desarrollador*